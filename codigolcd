#include <LiquidCrystal.h>

int botao = 6;
int estadoBotao;
int contador = 0;
int buzzer = 1;
int releuv = 8;

#define enable 8 // tem que ser pwm
#define input 9

#define timeLV 16
#define timeCent 31000
#define timeSecagem 31
#define timeCorrosao 31

void modoautomatico();
void displaylcd();
void modomanual();
void configuracoes();
void ajuda();
void centrifuga();
void secagem();
void luzvioleta();
void corrosao();

LiquidCrystal lcd(12, 11, 5, 4, 3, 2);

void setup()
{
  pinMode(botao, INPUT);
  pinMode(releuv, OUTPUT);
  lcd.begin(20, 4);
  Serial.begin(9600);
}

void loop()
{
  displaylcd();
}

void displaylcd()
{
  unsigned long time;
  lcd.clear();
  lcd.cursor();
  lcd.blink();
  lcd.setCursor(0, 0);
  lcd.print("->Modo Automatico");
  lcd.setCursor(0, 1);
  lcd.print("Aperte o botao");
  time = millis();
  do {
    estadoBotao = digitalRead(botao);
    if (estadoBotao == HIGH) {
      modoautomatico();
    }
  } while (time < 3001);
  lcd.clear();
  lcd.setCursor(0, 0);
  lcd.print("->Modo Manual");
  lcd.setCursor(0, 1);
  lcd.print("Aperte o botao");
  time = millis();
  do {
    estadoBotao = digitalRead(botao);
    if (estadoBotao == HIGH) {
      modomanual();
    }
  } while (time < 3001);
  lcd.clear();
  lcd.setCursor(0, 0);
  lcd.print("->Configuracoes");
  lcd.setCursor(0, 1);
  lcd.print("Aperte o botao");
  time = millis();
  do {
    estadoBotao = digitalRead(botao);
    if (estadoBotao == HIGH) {
      configuracoes();
    }
  } while (time < 3001);
  lcd.clear();
  lcd.setCursor(0, 0);
  lcd.print("->Ajuda");
  lcd.setCursor(0, 1);
  lcd.print("Aperte o botao");
  time = millis();
  do {
    estadoBotao = digitalRead(botao);
    if (estadoBotao == HIGH) {
      ajuda();
    }
  } while (time < 3001);
}

void modoautomatico()
{
  lcd.clear();
  lcd.setCursor(0, 0);
  lcd.print("Incializando...");
  delay(8000);
  lcd.clear();
  lcd.cursor();
  lcd.setCursor(0, 0);
  lcd.print("->Lave a placa");
  lcd.setCursor(0, 1);
  lcd.print("->com bombril");
  delay(5000);
  lcd.clear();
  lcd.cursor();
  lcd.setCursor(0, 0);
  lcd.print("-> Apos o termino");
  lcd.setCursor(0, 1);
  lcd.print("Pressione o botao");
  do {
    estadoBotao = digitalRead(botao);
  } while (estadoBotao != HIGH);
  lcd.clear();
  lcd.cursor();
  lcd.setCursor(0, 0);
  lcd.print("->Seque a placa");
  delay(5000);
  lcd.clear();
  lcd.cursor();
  lcd.setCursor(0, 0);
  lcd.print("-> Apos o termino");
  lcd.setCursor(0, 1);
  lcd.print("Pressione o botao");
  do {
    estadoBotao = digitalRead(botao);
  } while (estadoBotao != HIGH);
  lcd.clear();
  lcd.cursor();
  lcd.setCursor(0, 0);
  lcd.print("->Pinte a placa");
  delay(5000);
  lcd.clear();
  lcd.cursor();
  lcd.setCursor(0, 0);
  lcd.print("-> Apos o termino");
  lcd.setCursor(0, 1);
  lcd.print("Pressione o botao");
  do {
    estadoBotao = digitalRead(botao);
  } while (estadoBotao != HIGH);
  lcd.clear();
  lcd.setCursor(0, 0);
  lcd.print("->Agora vamos usar a");
  lcd.setCursor(5, 1);
  lcd.print("->Centrifuga");
  delay(5000);
  centrifuga();
  lcd.clear();
  lcd.setCursor(0, 0);
  lcd.print("->Vamos usar");
  lcd.setCursor(0, 1);
  lcd.print("a secagem");
  delay(5000);
  secagem();
  lcd.clear();
  lcd.setCursor(0, 0);
  lcd.print("->Colocar o");
  lcd.setCursor(0 , 1);
  lcd.print("fotolito");
  delay(5000);
  lcd.clear();
  lcd.cursor();
  lcd.setCursor(0, 0);
  lcd.print("-> Apos o termino");
  lcd.setCursor(0, 1);
  lcd.print("Pressione o botao");
  do {
    estadoBotao = digitalRead(botao);
  } while (estadoBotao != HIGH);
  lcd.clear();
  lcd.setCursor(0, 0);
  lcd.print("->Usar a luz ultravioleta");
  delay(5000);
  luzvioleta();
  lcd.clear();
  lcd.setCursor(0, 0);
  lcd.print("->Usar a barrilha");
  delay(5000);
  lcd.clear();
  lcd.cursor();
  lcd.setCursor(0, 0);
  lcd.print("-> Apos o termino");
  lcd.setCursor(0, 1);
  lcd.print("Pressione o botao");
  do {
    estadoBotao = digitalRead(botao);
  } while (estadoBotao != HIGH);
  lcd.clear();
  lcd.cursor();
  lcd.setCursor(0, 0);
  lcd.print("->Retirar a tinta");
  delay(5000);
  lcd.clear();
  lcd.cursor();
  lcd.setCursor(0, 0);
  lcd.print("-> Apos o termino");
  lcd.setCursor(0, 1);
  lcd.print("Pressione o botao");
  do {
    estadoBotao = digitalRead(botao);
  } while (estadoBotao != HIGH);
  lcd.clear();
  lcd.cursor();
  lcd.setCursor(0, 0);
  lcd.print("->Novamente usar");
  lcd.setCursor(0, 1);
  lcd.print("a luz UV");
  delay(5000);
  luzvioleta();
  lcd.clear();
  lcd.cursor();
  lcd.setCursor(0, 0);
  lcd.print("->Usar o hipercloreto");
  delay(5000);
  corrosao();
  lcd.clear();
  lcd.setCursor(0, 0);
  lcd.print("->Lavar placa");
  delay(5000);
  lcd.setCursor(0, 1);
  lcd.print("->Usar soda caustica");
  delay(5000);
  lcd.setCursor(0, 2);
  lcd.print("->Cortar e lixar placa");
  delay(5000);
  lcd.setCursor(0, 3);
  lcd.print("->Trabalhar as legendas");
  delay(5000);
  lcd.clear();
  lcd.setCursor(0, 0);
  lcd.print("->Agora, repetir as etapas de:");
  delay(5000);
  lcd.setCursor(0, 1);
  lcd.print("->Limpar, Pintar, Centrifugar, Secar");
  delay(5000);
  lcd.setCursor(0, 2);
  lcd.print("->Colocar a mascara");
  delay(5000);
  lcd.setCursor(0, 3);
  lcd.print("->Utilizar barrilha");
  delay(5000);
  lcd.clear();
  lcd.setCursor(5, 1);
  lcd.print("Processo Finalizado");
  displaylcd();
}

void modomanual()
{
  unsigned long time;
  lcd.clear();
  lcd.cursor();
  lcd.blink();
  lcd.setCursor(0, 0);
  lcd.print("Qual processo");
  lcd.setCursor(0, 1);
  lcd.print("deseja ativar?");
  delay(3000);
  lcd.clear();
  lcd.setCursor(0, 0);
  lcd.print("->Centrifuga?");
  lcd.setCursor(0, 1);
  lcd.print("Aperte o botao");
  time = millis();
  do {
    estadoBotao = digitalRead(botao);
    if (estadoBotao == HIGH) {
      centrifuga();
      time = 0;
      lcd.clear();
      lcd.setCursor(0, 1);
      lcd.print("Se deseja ativar");
      lcd.setCursor(0, 2);
      lcd.print("outro processo,");
      lcd.setCursor(0, 3);
      lcd.print("aperte o botao");
      time = millis();
      do {
        estadoBotao = digitalRead(botao);
        if (estadoBotao == HIGH)
          modomanual();
      } while (time < 3001);
      displaylcd();
    }
  } while (time < 3001);
  lcd.setCursor(0, 2);
  lcd.print("->Secagem?");
  lcd.setCursor(0, 3);
  lcd.print("Aperte o botao 2");
  do {
    estadoBotao = digitalRead(botao);
    if (estadoBotao == HIGH)
    {
      secagem();
      time = 0;
      lcd.clear();
      lcd.setCursor(0, 1);
      lcd.print("Se deseja ativar");
      lcd.setCursor(0, 2);
      lcd.print("outro processo,");
      lcd.setCursor(0, 3);
      lcd.print("aperte o botao");
      time = millis();
      do {
        estadoBotao = digitalRead(botao);
        if (estadoBotao == HIGH)
          modomanual();
      } while (time < 3001);
      displaylcd();
    }
  } while (time < 3001);
  lcd.clear();
  lcd.setCursor(0, 0);
  lcd.print("->Luz Ultravioleta?");
  lcd.setCursor(0, 1);
  lcd.print("Aperte o botao 3");
  time = millis();
  do {
    estadoBotao = digitalRead(botao);
    if (estadoBotao == HIGH)
    {
      luzvioleta();
      time = 0;
      lcd.clear();
      lcd.setCursor(0, 1);
      lcd.print("Se deseja ativar");
      lcd.setCursor(0, 2);
      lcd.print("outro processo,");
      lcd.setCursor(0, 3);
      lcd.print("aperte o botao");
      time = millis();
      do {
        estadoBotao = digitalRead(botao);
        if (estadoBotao == HIGH)
          modomanual();
      } while (time < 3001);
      displaylcd();
    }
  } while (time < 3001);
  lcd.setCursor(0, 2);
  lcd.print("->Corrosao?");
  lcd.setCursor(0, 3);
  lcd.print("Aperte o botao");
  time = millis();
  do {
    estadoBotao = digitalRead(botao);
    if (estadoBotao == HIGH)
    {
      corrosao();
      time = 0;
      lcd.clear();
      lcd.setCursor(0, 1);
      lcd.print("Se deseja ativar");
      lcd.setCursor(0, 2);
      lcd.print("outro processo,");
      lcd.setCursor(0, 3);
      lcd.print("aperte o botao");
      time = millis();
      do {
        estadoBotao = digitalRead(botao);
        if (estadoBotao == HIGH)
          modomanual();
      } while (time < 3001);
      displaylcd();
    }
  } while (time < 3001);
  lcd.clear();
}

void configuracoes()
{
  //Precisa da Matriz 4x4
}

void ajuda()
{

}

void centrifuga()
{
  unsigned long tempo = 0;
  int contador = 0;
  lcd.clear();
  lcd.setCursor(0, 0);
  lcd.print("Centrifugando...");
  delay(3000);
  lcd.setCursor(0, 1);
  digitalWrite(enable, HIGH);
  digitalWrite(input, HIGH);
  for (tempo; tempo < 1000 && contador < timeCent; contador++)
  {
    lcd.print("Centrifugando...");
    lcd.print(contador);
    delay(1000);
    lcd.clear();
    tempo = millis();
  }
  digitalWrite(enable, LOW);
  digitalWrite(input, LOW);
  do {
    tone(buzzer, 261);
  } while (estadoBotao != HIGH);
  noTone(buzzer);
}

void secagem()
{
  unsigned long tempo = 0;
  int contador = 0;

  lcd.clear();
  lcd.setCursor(0, 0);
  lcd.print("Secagem...");
  delay(3000);
  lcd.setCursor(0, 1);
  lcd.print("Pressione para iniciar");
  do {
    estadoBotao = digitalRead(botao);
  } while (estadoBotao != HIGH);
  lcd.clear();
  lcd.setCursor(7, 0);
  lcd.print("Secando");
  delay(3000);
  lcd.clear();
  lcd.setCursor(10, 1);
  tempo = millis();
  for (tempo; tempo < 60000 && contador < timeSecagem; contador++)
  {
    lcd.print("Secando...");
    lcd.print(contador);
    delay(1000);
    lcd.clear();
    tempo = 0;
  }
  do {
    tone(buzzer, 261);
  } while (estadoBotao != HIGH);
  noTone(buzzer);
}

void luzvioleta()
{
  unsigned long tempo = 0;
  int contador = 0;

  lcd.clear();
  lcd.setCursor(7, 0);
  lcd.print("Luz UV");
  delay(3000);
  lcd.clear();
  lcd.setCursor(10, 1);
  tempo = millis();
  digitalWrite(releuv, HIGH);
  for (tempo; tempo < 60000 && contador < timeLV; contador++)
  {
    lcd.print("Luz UV...");
    lcd.print(contador);
    delay(1000);
    lcd.clear();
    tempo = 0;
  }
  digitalWrite(releuv, LOW);
  do {
    tone(buzzer, 261);
  } while (estadoBotao != HIGH);
  noTone(buzzer);
}

void corrosao()
{
  unsigned long tempo = 0;
  int contador = 0;

  lcd.clear();
  lcd.setCursor(7, 0);
  lcd.print("Corrosao...");
  delay(3000);
  lcd.setCursor(0, 1);
  lcd.print("Pressione para iniciar");
  do {
    estadoBotao = digitalRead(botao);
  } while (estadoBotao != HIGH);
  lcd.clear();
  lcd.setCursor(7, 0);
  lcd.print("Corroendo");
  lcd.setCursor(10, 1);
  tempo = millis();
  for (tempo; tempo < 60000 && contador < timeCorrosao; contador++)
  {
    lcd.print("Corroendo...");
    lcd.print(contador);
    delay(1000);
    lcd.clear();
    tempo = 0;
  }
  do {
    tone(buzzer, 261);
  } while (estadoBotao != HIGH);
  noTone(buzzer);
}
